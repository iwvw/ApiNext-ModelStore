"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const j=require("react"),v=require("lucide-react");var T={exports:{}},E={};var J;function ae(){if(J)return E;J=1;var o=Symbol.for("react.transitional.element"),a=Symbol.for("react.fragment");function u(g,i,d){var m=null;if(d!==void 0&&(m=""+d),i.key!==void 0&&(m=""+i.key),"key"in i){d={};for(var x in i)x!=="key"&&(d[x]=i[x])}else d=i;return i=d.ref,{$$typeof:o,type:g,key:m,ref:i!==void 0?i:null,props:d}}return E.Fragment=a,E.jsx=u,E.jsxs=u,E}var w={},U;function ne(){if(U)return w;U=1;var o={};return o.NODE_ENV!=="production"&&(function(){function a(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===te?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case k:return"Fragment";case V:return"Profiler";case G:return"StrictMode";case Z:return"Suspense";case Q:return"SuspenseList";case ee:return"Activity"}if(typeof e=="object")switch(typeof e.tag=="number"&&console.error("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),e.$$typeof){case q:return"Portal";case H:return e.displayName||"Context";case X:return(e._context.displayName||"Context")+".Consumer";case B:var r=e.render;return e=e.displayName,e||(e=r.displayName||r.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case K:return r=e.displayName||null,r!==null?r:a(e.type)||"Memo";case S:r=e._payload,e=e._init;try{return a(e(r))}catch{}}return null}function u(e){return""+e}function g(e){try{u(e);var r=!1}catch{r=!0}if(r){r=console;var n=r.error,l=typeof Symbol=="function"&&Symbol.toStringTag&&e[Symbol.toStringTag]||e.constructor.name||"Object";return n.call(r,"The provided key is an unsupported type %s. This value must be coerced to a string before using it here.",l),u(e)}}function i(e){if(e===k)return"<>";if(typeof e=="object"&&e!==null&&e.$$typeof===S)return"<...>";try{var r=a(e);return r?"<"+r+">":"<...>"}catch{return"<...>"}}function d(){var e=A.A;return e===null?null:e.getOwner()}function m(){return Error("react-stack-top-frame")}function x(e){if($.call(e,"key")){var r=Object.getOwnPropertyDescriptor(e,"key").get;if(r&&r.isReactWarning)return!1}return e.key!==void 0}function h(e,r){function n(){z||(z=!0,console.error("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://react.dev/link/special-props)",r))}n.isReactWarning=!0,Object.defineProperty(e,"key",{get:n,configurable:!0})}function f(){var e=a(this.type);return Y[e]||(Y[e]=!0,console.error("Accessing element.ref was removed in React 19. ref is now a regular prop. It will be removed from the JSX Element type in a future release.")),e=this.props.ref,e!==void 0?e:null}function y(e,r,n,l,R,P){var c=n.ref;return e={$$typeof:L,type:e,key:r,props:n,_owner:l},(c!==void 0?c:null)!==null?Object.defineProperty(e,"ref",{enumerable:!1,get:f}):Object.defineProperty(e,"ref",{enumerable:!1,value:null}),e._store={},Object.defineProperty(e._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:0}),Object.defineProperty(e,"_debugInfo",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.defineProperty(e,"_debugStack",{configurable:!1,enumerable:!1,writable:!0,value:R}),Object.defineProperty(e,"_debugTask",{configurable:!1,enumerable:!1,writable:!0,value:P}),Object.freeze&&(Object.freeze(e.props),Object.freeze(e)),e}function s(e,r,n,l,R,P){var c=r.children;if(c!==void 0)if(l)if(re(c)){for(l=0;l<c.length;l++)p(c[l]);Object.freeze&&Object.freeze(c)}else console.error("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else p(c);if($.call(r,"key")){c=a(e);var _=Object.keys(r).filter(function(se){return se!=="key"});l=0<_.length?"{key: someKey, "+_.join(": ..., ")+": ...}":"{key: someKey}",F[c+l]||(_=0<_.length?"{"+_.join(": ..., ")+": ...}":"{}",console.error(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,l,c,_,c),F[c+l]=!0)}if(c=null,n!==void 0&&(g(n),c=""+n),x(r)&&(g(r.key),c=""+r.key),"key"in r){n={};for(var C in r)C!=="key"&&(n[C]=r[C])}else n=r;return c&&h(n,typeof e=="function"?e.displayName||e.name||"Unknown":e),y(e,c,n,d(),R,P)}function p(e){b(e)?e._store&&(e._store.validated=1):typeof e=="object"&&e!==null&&e.$$typeof===S&&(e._payload.status==="fulfilled"?b(e._payload.value)&&e._payload.value._store&&(e._payload.value._store.validated=1):e._store&&(e._store.validated=1))}function b(e){return typeof e=="object"&&e!==null&&e.$$typeof===L}var N=j,L=Symbol.for("react.transitional.element"),q=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),G=Symbol.for("react.strict_mode"),V=Symbol.for("react.profiler"),X=Symbol.for("react.consumer"),H=Symbol.for("react.context"),B=Symbol.for("react.forward_ref"),Z=Symbol.for("react.suspense"),Q=Symbol.for("react.suspense_list"),K=Symbol.for("react.memo"),S=Symbol.for("react.lazy"),ee=Symbol.for("react.activity"),te=Symbol.for("react.client.reference"),A=N.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,$=Object.prototype.hasOwnProperty,re=Array.isArray,O=console.createTask?console.createTask:function(){return null};N={react_stack_bottom_frame:function(e){return e()}};var z,Y={},D=N.react_stack_bottom_frame.bind(N,m)(),M=O(i(m)),F={};w.Fragment=k,w.jsx=function(e,r,n){var l=1e4>A.recentlyCreatedOwnerStacks++;return s(e,r,n,!1,l?Error("react-stack-top-frame"):D,l?O(i(e)):M)},w.jsxs=function(e,r,n){var l=1e4>A.recentlyCreatedOwnerStacks++;return s(e,r,n,!0,l?Error("react-stack-top-frame"):D,l?O(i(e)):M)}})(),w}var W;function oe(){if(W)return T.exports;W=1;var o={};return o.NODE_ENV==="production"?T.exports=ae():T.exports=ne(),T.exports}var t=oe();const I=({title:o,value:a,sub:u,icon:g,color:i="text-primary"})=>t.jsxs("div",{className:"p-4 rounded-xl border bg-card text-card-foreground shadow-sm flex items-center gap-4",children:[t.jsx("div",{className:`p-3 rounded-lg bg-muted ${i}`,children:t.jsx(g,{className:"w-6 h-6"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:o}),t.jsx("h3",{className:"text-2xl font-bold",children:a}),u&&t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:u})]})]}),le=({logs:o})=>t.jsxs("div",{className:"flex flex-col h-full overflow-hidden bg-zinc-950 text-zinc-300 font-mono text-sm rounded-lg border border-zinc-800",children:[t.jsxs("div",{className:"flex items-center justify-between px-4 py-2 border-b border-zinc-800 bg-zinc-900",children:[t.jsxs("span",{className:"font-semibold flex items-center gap-2",children:[t.jsx(v.Terminal,{className:"w-4 h-4"})," Live Logs"]}),t.jsxs("span",{className:"text-xs text-zinc-500",children:[o.length," events"]})]}),t.jsxs("div",{className:"flex-1 overflow-auto p-4 space-y-2",children:[o.map(a=>t.jsxs("div",{className:"group flex gap-3 hover:bg-zinc-900/50 p-1 -mx-1 rounded",children:[t.jsx("span",{className:"text-zinc-600 shrink-0",children:new Date(a.timestamp).toLocaleTimeString()}),t.jsxs("div",{className:"flex-1 space-y-1",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:`px-1.5 py-0.5 rounded text-[10px] font-bold ${a.status===200?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:a.status===200?"OK":"ERR"}),t.jsx("span",{className:"text-zinc-400",children:a.model}),t.jsxs("span",{className:"text-zinc-500 text-xs",children:["via ",a.account]})]}),a.has_thinking&&t.jsxs("div",{className:"text-purple-400 text-xs flex items-center gap-1",children:[t.jsx("span",{className:"w-1 h-3 bg-purple-500 rounded-full inline-block"}),"Thinking Process Captured"]}),a.error&&t.jsx("div",{className:"text-red-400 break-all",children:a.error})]}),t.jsxs("span",{className:"text-zinc-500 shrink-0",children:[a.duration,"ms"]})]},a.id)),o.length===0&&t.jsx("div",{className:"text-zinc-600 text-center py-10 italic",children:"Waiting for requests..."})]})]}),ce=({accounts:o,onUpdate:a,onRefresh:u})=>{const[g,i]=j.useState(!1),[d,m]=j.useState(""),[x,h]=j.useState(!1),f={total:o.length,active:o.filter(s=>s.is_active).length,errors:o.reduce((s,p)=>s+(p.error_count||0),0)},y=()=>{try{const s=JSON.parse(d);Array.isArray(s)?(a(s),h(!1),m("")):alert("Invalid format: Expected an array of accounts.")}catch{alert("Invalid JSON")}};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsx(I,{title:"Active Accounts",value:f.active,sub:`Total: ${f.total}`,icon:v.Server,color:"text-blue-500"}),t.jsx(I,{title:"Health Status",value:f.errors===0?"Healthy":"Degraded",sub:`${f.errors} errors detected`,icon:v.Activity,color:f.errors===0?"text-green-500":"text-orange-500"}),t.jsx(I,{title:"Project IDs",value:o.filter(s=>!!s.project_id).length,sub:"Auto-detected",icon:v.Shield,color:"text-purple-500"})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:u,className:"p-2 hover:bg-muted rounded-md transition-colors",title:"Refresh",children:t.jsx(v.RotateCcw,{className:"w-4 h-4"})}),t.jsx("h3",{className:"font-semibold text-lg",children:"Account List"})]}),t.jsx("div",{className:"flex gap-2",children:t.jsxs("button",{onClick:()=>h(!x),className:"flex items-center gap-2 px-3 py-1.5 bg-primary text-primary-foreground text-sm rounded-md shadow hover:bg-primary/90 transition-colors",children:[t.jsx(v.Plus,{className:"w-4 h-4"})," Import JSON"]})})]}),x&&t.jsxs("div",{className:"p-4 border rounded-lg bg-muted/30 space-y-3 animate-in fade-in slide-in-from-top-2",children:[t.jsx("h4",{className:"font-medium text-sm",children:"Paste Account JSON (Array)"}),t.jsx("textarea",{className:"w-full h-32 p-2 rounded-md font-mono text-xs bg-background border focus:ring-2 ring-primary/20 outline-none",placeholder:'[{"name": "acc1", "credentials": {...}}]',value:d,onChange:s=>m(s.target.value)}),t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx("button",{onClick:()=>h(!1),className:"px-3 py-1 text-sm",children:"Cancel"}),t.jsx("button",{onClick:y,className:"px-3 py-1 bg-primary text-primary-foreground text-sm rounded shadow",children:"Save & Overwrite"})]})]}),t.jsx("div",{className:"border rounded-lg overflow-hidden",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{className:"bg-muted/50 border-b",children:t.jsxs("tr",{className:"text-left text-muted-foreground",children:[t.jsx("th",{className:"p-3 font-medium",children:"Status"}),t.jsx("th",{className:"p-3 font-medium",children:"Name"}),t.jsx("th",{className:"p-3 font-medium",children:"Project ID"}),t.jsx("th",{className:"p-3 font-medium",children:"Last Used"}),t.jsx("th",{className:"p-3 font-medium text-right",children:"Actions"})]})}),t.jsxs("tbody",{className:"divide-y",children:[o.map(s=>t.jsxs("tr",{className:"hover:bg-muted/20 transition-colors",children:[t.jsx("td",{className:"p-3",children:s.is_active?t.jsx(v.CheckCircle,{className:"w-4 h-4 text-green-500"}):t.jsx(v.XCircle,{className:"w-4 h-4 text-zinc-400"})}),t.jsx("td",{className:"p-3 font-medium",children:s.name}),t.jsx("td",{className:"p-3 font-mono text-xs text-muted-foreground",children:s.project_id||"Pending..."}),t.jsx("td",{className:"p-3 text-xs text-muted-foreground",children:s.last_used_at?new Date(s.last_used_at).toLocaleTimeString():"-"}),t.jsxs("td",{className:"p-3 text-right flex justify-end gap-2 text-muted-foreground",children:[t.jsx("button",{title:"Edit",className:"hover:text-primary",children:t.jsx(v.Edit2,{className:"w-3.5 h-3.5"})}),t.jsx("button",{title:"Delete",className:"hover:text-destructive",children:t.jsx(v.Trash2,{className:"w-3.5 h-3.5"})})]})]},s.id)),o.length===0&&t.jsx("tr",{children:t.jsx("td",{colSpan:5,className:"p-8 text-center text-muted-foreground",children:"No accounts configured"})})]})]})})]})};function ie({locale:o}){const[a,u]=j.useState("accounts"),[g,i]=j.useState([]),[d,m]=j.useState([]),[x,h]=j.useState(!1);j.useEffect(()=>{const s=async()=>{try{const b=await fetch("/api/v1/gateway/gemini-cli/logs");if(b.ok){const N=await b.json();m(N)}}catch{}};s();const p=setInterval(s,2e3);return()=>clearInterval(p)},[]);const f=async()=>{try{h(!0);const s=await fetch("/api/v1/gateway/gemini-cli/accounts");s.ok&&i(await s.json())}finally{h(!1)}};j.useEffect(()=>{f()},[]);const y=async s=>{try{h(!0);const p=await fetch("/api/v1/gateway/gemini-cli/accounts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(p.ok)await f();else{const b=await p.json();alert("Failed: "+b.error)}}catch{alert("Network Error")}finally{h(!1)}};return t.jsxs("div",{className:"w-full h-full p-6 space-y-6 max-w-6xl mx-auto",children:[t.jsxs("div",{className:"flex items-center justify-between pb-6 border-b",children:[t.jsxs("div",{className:"space-y-1",children:[t.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"Gemini CLI Manager"}),t.jsx("p",{className:"text-muted-foreground",children:"Manage multi-account rotation and internal API gateways."})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>u("accounts"),className:`px-4 py-2 rounded-full text-sm font-medium transition-all ${a==="accounts"?"bg-primary text-primary-foreground shadow":"hover:bg-muted"}`,children:"Accounts"}),t.jsx("button",{onClick:()=>u("logs"),className:`px-4 py-2 rounded-full text-sm font-medium transition-all ${a==="logs"?"bg-primary text-primary-foreground shadow":"hover:bg-muted"}`,children:"Live Logs"})]})]}),t.jsx("div",{className:x?"opacity-50 pointer-events-none transition-opacity":"",children:a==="accounts"?t.jsx(ce,{accounts:g,onUpdate:y,onRefresh:f}):t.jsx("div",{className:"h-[600px]",children:t.jsx(le,{logs:d})})})]})}exports.default=ie;
